version: "3.9"

services:
  keycloak:
    image: quay.io/keycloak/keycloak:24.0.0
    container_name: keycloak
    # Auto-import realms from /opt/keycloak/data/import (see infra/keycloak/README.md)
    command: ["start-dev", "--import-realm"]
    environment:
      KEYCLOAK_ADMIN: admin
      KEYCLOAK_ADMIN_PASSWORD: admin
    ports:
      - "8080:8080"
    # Persist Keycloak data (realms, users, roles) between restarts
    volumes:
      - keycloak_data:/opt/keycloak/data
      # Folder in repo containing exported realms to share via Git
      - ./infra/keycloak:/opt/keycloak/data/import
    restart: unless-stopped

volumes:
  keycloak_data:
